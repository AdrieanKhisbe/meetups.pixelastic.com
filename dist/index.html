<!doctype html>
<html class="no-js" lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
       Meetups 
    </title>
    <meta name="description" content="Compte-rendus des meetups et conférences auxquels j'assiste">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <!-- fileblock:css css -->
    <link href="/css/normalize.css" rel="stylesheet" />
    <link href="/css/base.css" rel="stylesheet" />
    <link href="/css/code.css" rel="stylesheet" />
    <link href="/css/fonts.css" rel="stylesheet" />
    <link href="/css/headings.css" rel="stylesheet" />
    <link href="/css/layout.css" rel="stylesheet" />
    <link href="/css/links.css" rel="stylesheet" />
    <link href="/css/lists.css" rel="stylesheet" />
    <link href="/css/misc.css" rel="stylesheet" />
    <link href="/css/pagination.css" rel="stylesheet" />
    <link href="/css/posts.css" rel="stylesheet" />
    <link href="/css/quotes.css" rel="stylesheet" />
    <link href="/css/search.css" rel="stylesheet" />
    <link href="/css/tables.css" rel="stylesheet" />
    <link href="/css/youtube.css" rel="stylesheet" />
    <!-- endfileblock -->

    <link rel="shortcut icon" href="/favicon.ico">

    <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  </head>

  <body>
    <div class="sidebar">
      <div class="sidebar-about">
        <h1><a href="/index.html">Meetups</a></h1>
        <p class="lead">Compte-rendus des meetups et conférences auxquels j'assiste</p>
      </div>

      <!--This is a CSS trick to hide/show the sidebar for mobiles-->
      <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-item active">
          <a href="/">Accueil</a>
        </li>
        <li class="sidebar-nav-item">
          <a href="/about/">À propos</a>
        </li>
        <li class="sidebar-nav-item">
          <a href="/archive/">Archive</a>
        </li>
      </ul>

      <form id="sidebar-search-form" class="sidebar-search" method="GET">
        <input type="text" id="sidebar-search-input" class="sidebar-search-input" placeholder="Search"/>
      </form>
      <script id="search-results-empty-template" language="x-template">
          <p class="search-results-empty">Aucun résultat trouvé.</p>
      </script>
      <script id="search-results-post-template" language="x-template">
        <div class="post">
        <h1 class="post-title"><a href="<%= url %>"><%= title %></a></h1>
          <span class="post-date"><%= date %></span>
          <%= content %>
        </div>
      </script>

      <label for="sidebar-checkbox" class="sidebar-toggle-menu"></label>

      <div class="footer">Code source disponible sur <a href="https://github.com/pixelastic/blog.pixelastic.com">GitHub</a></div>
    </div>
    <div class="layout">
      <div class="content" id="content">

        <div class="content-search">
          <h1 class="page-title">Rechercher</h1>
          <div class="posts search-results" id="search-results"></div>
        </div>

        <div class="content-display">
          <div class="posts posts-display">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/02/01/bref-on-fait-une-conference/">
        Bref, on a fait une conférence
      </a>
    </h1>

    <span class="post-date">01 Feb 2015</span>

    <p>Vendredi soir avait lieu au <a href="http://www.theatredurondpoint.fr/">théatre du Rond-Point</a> une conférence de
<a href="https://twitter.com/kyank">Kyan</a> et <a href="https://twitter.com/Navo_">Navo</a> sur leur processus créatif lors de la conception de la
série <a href="https://www.youtube.com/user/bref">Bref</a>. J&#39;avais déjà eu la chance d&#39;écouter cette conférence il
y a quelques mois, mais la voir en live cette fois-ci m&#39;a donné envie de
partager un compte-rendu des conseils qui y étaient donnés.</p>

<p>Leurs conseils viennent de leur expérience dans la création d&#39;une série courte
comique, mais la trés grande majorité des conseils peuvent s&#39;appliquer
à n&#39;importe quel acte de création, depuis l&#39;écriture d&#39;un roman à la fondation
d&#39;une startup.</p>

<h3>Vous avez quelque chose à dire</h3>

<p>Le premier conseil pour se lancer est de ne pas croire qu&#39;on n&#39;a rien
d&#39;intéressant à dire ou à offrir. On était une centaine dans la salle
à assister à la même conférence, néanmoins si on avait du chacun écrire sur un
papier notre expérience, on aurait tous raconté quelque chose de différent. Un
même événement peut être raconté de manières complétement différentes et aucune
n&#39;est plus légitime qu&#39;une autre.</p>

<h3>Just do it.</h3>

<p>Au delà du slogan de Nike, cet adage est l&#39;un des plus importants pour moi.
C&#39;est bien beau d&#39;avoir des idées, mais sans leur réalisation, l&#39;idée ne vaut
rien. J&#39;ai rencontré beaucoup d&#39;<em>entrepreneurs</em> qui étaient persuadés d&#39;avoir
l&#39;idée du siècle et qui avaient <em>juste</em> besoin d&#39;un développeur pour la
réaliser.</p>

<p>C&#39;est pas comme ça que ça marche. C&#39;est extrémement simple d&#39;avoir des idées.
Tout le monde a des idées, et c&#39;est même très probable que d&#39;autres personnes
aient exactement les mêmes idées que vous. Mais imaginer un concept ou un
produit dans sa tête c&#39;est trop facile. Tout le monde peut être un génie
dans sa propre tête. C&#39;est quand on sort son idée dans le monde réel que la
véritable aventure commence.</p>

<p>Parce qu&#39;une fois qu&#39;on la sort dans le monde extérieur, qu&#39;on la confronte
à d&#39;autres personnes, à un marché, on risque de se prendre des murs, on risque
de se planter. Notre si belle idée n&#39;est finalement peut-être pas viable. Mais
sans cette étape, on ne l&#39;aurait jamais su. Il est donc indispensable de faire
des choses, de passer son idée de simple concept à une réalisation concrète.</p>

<p>Des gens qui ont des idées il doit y en avoir approximativement 7 milliards sur
Terre. Des gens qui réalisent quelque chose à partir de ces idées, il y en
a déjà beaucoup moins, et ceux qui parviennent au bout de leur réalisation sont
vraiment très peu.</p>

<p>Faites des choses, tentez, essayez, plantez-vous. Si vous ne vous plantez pas,
c&#39;est que vous n&#39;avez pas innové. Si vous réussissez du premier coup, c&#39;est que
votre idée n&#39;a rien de révolutionnaire.</p>

<h3>Dumpez</h3>

<p>Adeptes du <a href="http://fr.wikipedia.org/wiki/Getting_Things_Done">GTD</a> ou de <a href="http://ankisrs.net/">Anki</a>, vous devez connaitre ce principe. Dumpez.
Ne laissez pas votre esprit être encombré de trop de choses. Vous avez une
idée, notez là dans un carnet, envoyez-vous un mail, mettez là sur
<a href="https://evernote.com/intl/fr/">Evernote</a>. Vous ne pourrez sans doute rien en
faire aujourd&#39;hui, mais au moins vous l&#39;avez notée et un jour viendra où vous
pourrez vous en resservir.</p>

<p>Kyan donne l&#39;exemple du carnet dans lequel il note le nom des acteurs qu&#39;il
a aimé voir au théatre. Navo écrit sur son blog depuis des années des tas de
pensées. En quand ils ont du réaliser Bref, ils ont acceléré leur casting grâce
au carnet de Kyan, et ont pu transformer des notes de blog en épisodes.</p>

<p>Lors de l&#39;écriture de Bref, ils ont balancé en vrac toutes les vannes, tous les
trucs drôles qu&#39;ils avaient en tête et dans leurs carnets. Ensuite, ils les ont
regroupés sous des thèmes communs, qui ont ensuite donné lieu aux épisodes. Ils
appellent cette technique des &quot;jouets et des chambres&quot;. J&#39;utilise quelque chose
de très similaire quand j&#39;écris mes scènarios de jeu de rôle et ça permet
d&#39;avoir une matière première très facilement.</p>

<h3>N&#39;ayez pas peur de montrer ce que vous faites</h3>

<p>Je vois beaucoup d&#39;entrepreneurs qui ne veulent pas parler de leurs idées de
peur de se les faire voler. Encore une fois, les idées ne valent rien sans leur
réalisation. Mais surtout, en empechant l&#39;idée se se faire connaitre ils
empechent complétement leur projet d&#39;aboutir.</p>

<p>Peut-être allez-vous vous faire voler votre idée. Et alors ? Des idées vous en
aurez d&#39;autres, non ? Je l&#39;espère pour vous en tout cas. Si vous pensez que
vous n&#39;avez eu qu&#39;une seule bonne idée de toute votre vie, laissez moi vous
dire qu&#39;il y a peu de chance que cette idée soit bonne. </p>

<p>Les gens qui ont des bonnes idées les ont par dizaines. Ce sont des poules aux
œufs d&#39;or. Ils pourront continuer d&#39;en avoir, même si on leur en vole une.
Alors que les voleurs sont incapables d&#39;avoir des idées. En vous volant votre
idée, le voleur vous a rendu service. Vous savez que c&#39;est un voleur
maintenant, et vous ne lui ferez plus confiance et vous ne vous ferez pas voler
votre prochaine idée qui est encore mieux.</p>

<p>De toutes façons, vous y gagnerez plus à vous faire voler une idée et la voir
grandir dans le monde réel, même si vous n&#39;y participez pas, plutot que de ne
rien produire du tout.</p>

<p>Encore une fois, tout le monde a des idées, mais peu de personnes sont capables
de les réaliser. C&#39;est pas grave de se faire piquer des idées, c&#39;est pas ça qui
manque. Et on ne peut pas vous voler votre capacité de réalisation, c&#39;est ça
qui compte.</p>

<p>J&#39;ai beaucoup aimé le petit dialogue imagé entre Kyan et Navo sur ce sujet :</p>

<blockquote>
<p>— Oh, j&#39;ai une super idée.</p>

<p>— Ah ouais, c&#39;est quoi ?</p>

<p>— Nan, je peux pas te le dire, tu va me la voler.</p>

<p>— Ah. Ben viens, je te présente quelqu&#39;un.</p>

<p>— Nan, nan. Il va me voler mon idée lui aussi.</p>

<p>— Comme tu veux...</p>

<p>— C&#39;était qui d&#39;ailleurs ?</p>

<p>— Le succès.</p>
</blockquote>

<h3>Ayez de la chance</h3>

<p>Ce conseil parait idiot, mais c&#39;est l&#39;un des conseils les plus importants pour
réussir. Personne ne parvient à créer quelque chose de neuf sans avoir de la
chance. Mais surtout la chance, ça se provoque.</p>

<p>Navo aime à raconter l&#39;histoire de cet homme très croyant qui jour après jour,
pendant des années, prie Dieu pour lui demander de le faire gagner au loto. Si
bien qu&#39;après des années Dieu lui apparait et lui dit : &quot;Écoute, je veux bien
te faire gagner au loto. Mais s&#39;il te plait, joue.&quot;</p>

<p>Beaucoup de gens pensent que la chance arrive comme ça, sans raison. Qu&#39;un jour
un producteur ou un investisseur va venir frapper à votre porte alors que vous
êtes chez vous en slip en train de réfléchir à votre idée et vous proposer
beaucoup d&#39;argent pour enfin la réaliser.</p>

<p>Non.</p>

<p>Ça ne marche pas comme ça. Avant de pouvoir récolter de la chance, il faut
savoir semer du risque. La chance, ça se provoque. Il faut tenter des choses,
se faire voir, rencontrer du monde, partager, montrer ce qu&#39;on fait. Le talent
et la créativité ne font pas tout, la chance a aussi une part énorme à jouer.</p>

<p>Il faut savoir accepter la chance, la respecter, et la provoquer.</p>

<h3>Créez votre famille</h3>

<p>Même quand vous faites quelque chose de chiant, faites-le bien. Si vous
travaillez un jour avec quelqu&#39;un et que vous faites un sale boulot, il s&#39;en
souviendra et le jour où il aura besoin de quelqu&#39;un pour monter son projet,
vous pouvez être sur que ce n&#39;est pas vous qu&#39;il appelera.</p>

<p>Encore une fois, le plus important c&#39;est pas l&#39;idée, c&#39;est l&#39;équipe qui va la
réaliser. Il y a des gens avec qui on a travaillé, on a apprécié leur travail
autant que leur personne, on sait qu&#39;on les rappellera pour travailler
à nouveau avec eux dans le futur. On sait qu&#39;on peut leur faire confiance, on
sait comment ils travaillent, on est dans une ambiance de bienveillance.</p>

<p>Vous ne savez jamais si le petit boulot que vous êtes en train de faire
aujourd&#39;hui ne vous permettra pas de faire quelque chose de bien plus grand
plus tard, simplement parce qu&#39;on se souvient de vous comme quelqu&#39;un qui bosse
bien.</p>

<h3>Ne laissez pas l&#39;argent vous brider</h3>

<p>Et bizarrement quand je dis ça, je ne pense pas au manque d&#39;argent, mais au
surplus d&#39;argent. À un moment, votre projet fonctionnera. Vous gagnerez des
sous avec et se posera la question de quoi faire avec ces montants.</p>

<p>Vous vous souviendrez du moment où vous avez commencé, où vous avez réussi
à faire beaucoup avec peu de moyens. Maintenant on vous offre un chèque avec
plein de zeros pour continuer. Il pourrait être tentant de se dire &quot;<em>Bon, je
vais faire juste 90% de ce que j&#39;avais prévu, ce qui est déjà bien, et garder
les 10% restant pour ma poche</em>&quot;.</p>

<p>Non.</p>

<p>Il faut que vous fassiez 110% de ce que vous aviez prévu. Mettez vous en galère,
allez plus loin encore. Ce n&#39;est que le début. Vous serez riche plus tard. Là
vous avez encore beaucoup à apprendre, beaucoup à prouver, il ne faut pas
s&#39;arreter maintenant. En faisant ainsi, vous vous donnerez à fond et irez
encore plus loin.</p>

<p>Le plus mauvais conseil qu&#39;on puisse vous donner quand vous monter votre projet
viens bien souvent de vos proches. Ils voient que votre idée fonctionne et vous
disent &quot;<em>T&#39;es payé combien ? Fais attention à ne pas te faire avoir</em>&quot;.</p>

<p>Worst advice ever.</p>

<p>Après ça vous allez avoir un petit démon dans un coin de votre tête qui va
venir vous emmerder à chaque fois que vous aller pondre une nouvelle idée. Vous
allez brider votre créativité en vous disant &quot;<em>Non, je mérite mieux que ça</em>&quot;,
&quot;<em>Ça, je le garde pour moi</em>&quot;. On s&#39;en fout de combien vous êtes payé, vous
faites ce que vous rêvez de faire, ne laissez pas une hypothétique somme
d&#39;argent vous brider avant même d&#39;avoir commencé.</p>

<p>Ils sont nombreux les groupes de rock fondés par des gamsin de 15 ans qui
splittent avant même d&#39;avoir écrit leur première chanson car ils se voient déjà
en haut de l&#39;affiche et s&#39;engueulent pour savoir comment partager les gains de
leur hit idéalisé. Ne soyez pas ces gamins. Faites.</p>

<h3>La contrainte peut être libératrice</h3>

<p>Parfois une contrainte, un impondérable va vous forcer à revoir vos plans. Ce
que vous aviez prévu de faire ne peut pas être fait comme prévu. Vous avez
alors deux choix : annuler ou trouver une solution.</p>

<p>Et c&#39;est bien souvent quand on a des contraintes fortes qu&#39;on parvient
à trouver des solutions créatives que nous n&#39;aurions autrement jamais
imaginées. Et ces solutions peuvent bien souvent être aussi utilisées dans des
situations normales, là où la contrainte n&#39;existe pas, pour rendre le process
encore plus agréable, rapide, utile.</p>

<p>Ne vous découragez pas face à une contrainte, il y a forcément une solution, et
bien souvent elle vous ferez explorer quelque chose d&#39;inédit.</p>

<h3>Qu&#39;est-ce qu&#39;un gars plus fort que moi ferai ?</h3>

<p>Quand vous avez réussi à faire ce que vous vouliez, que vous pensez en avoir
fini, demandez-vous &quot;<em>Qu&#39;est-ce qu&#39;un gars plus fort que moi ferai à ma place
?</em>&quot;. En essayant de vous mettre dans la peau de quelqu&#39;un plus fort que vous,
vous parviendrez à être plus fort que vous même.</p>

<p>Ça parait bizarre comme conseil, mais essayez, vous verrez.</p>

<h3><a href="http://www.partageons-ce-qui-nous-departage.com/le-non-est-toujours-acquis">Le non est toujours acquis</a></h3>

<p>Bien souvent, vous allez rencontrer des gens dans des métiers annexes au votre
avec qui vous devez intéragir qui vont vous dire &quot;<em>Nope, désolé, c&#39;est pas
possible.</em>&quot;. Bien souvent, en creusant un peu, vous comprendrez que ce n&#39;est pas
pour eux que la tache est impossible, mais parce qu&#39;ils pensent que quelqu&#39;un
d&#39;autre, un peu plus loin dans la chaine ne voudra pas.</p>

<p>Si vous commencez à entendre des choses comme &quot;<em>Non mais c&#39;est même pas la
peine d&#39;essayer, ils voudront jamais</em>&quot;, &quot;<em>Ça fait 15 ans que je fais ce métier,
je peux te dire qu&#39;ils ne voudront pas.</em>&quot;. Répondez simplement &quot;<em>Viens, on
essaye.</em>&quot;, &quot;<em>Viens, on essaye</em>&quot; jusqu&#39;à ce qu&#39;il accepte effectivement
d&#39;essayer.</p>

<p>Et vous serez surpris du nombre de fois où finalement il n&#39;y avait pas de réel
obstacle sur la voie, juste des gens qui pensent que des gens pensent qu&#39;il va
y avoir des obstacles et donc bloquent dès le début. </p>

<p>Et ça n&#39;arrive pas qu&#39;aux autres. Faites attention à la petite voix dans votre
tête qui dit &quot;<em>Non, ils voudront pas, c&#39;est pas la peine que je demande</em>&quot; aussi.</p>

<h3>Consensus</h3>

<p>Quand on monte un projet à plusieurs, il est fondamental que les idées mises en
place plaisent à tout le monde. Si vous devez batailler pour convaincre l&#39;autre
que votre idée est bonne, changez d&#39;idée. N&#39;oubliez pas que vous êtes des
poules aux œufs d&#39;or. Bien souvent il existe une autre idée qui satisfait tout
le monde pile entre la votre et celle de votre associé.</p>

<p>Si jamais on vous impose une idée et que le projet ne fonctionne pas, vous
serez tenté de dire &quot;<em>Ouais mais je le savais, j&#39;en voulais pas de ça moi.</em>&quot;.
Et au contraire si c&#39;est votre idée qui est acceptée et que le projet
fonctionne, vous aller penser &quot;<em>Je le savais, mes idées sont vraiment
meilleures</em>&quot;. Et les rancunes et les dissenssions vont commencer à partir de
là.</p>

<p>Trouvez une idée avec laquelle vous soyez tous d&#39;accord, que vous puissiez tous
défendre et porter. Si votre idée ne convient pas, pas de soucis, trouvez-en
une autre et gardez votre idée pour un autre projet.</p>

<h3>Attention aux détails</h3>

<p>Octroyez-vous le pouvoir de tout maitriser, toute la chaine, jusqu&#39;au bout.
Même si vous avez fait le gros du travail, faites attention aux petits détails,
tout le temps, partout.</p>

<p>Kyan raconte une anecdote très vraie d&#39;un magicien américain qui vient faire un
spectacle en France. Il répète son tour depuis des années, il est parfaitement
au point, il s&#39;est beaucoup investi dedans, il a même divorcé à cause de ça. Il
est capable de faire téléporter une petite fille depuis un bout de la scène
vers l&#39;autre.</p>

<p>Et au moment de monter sur scène, le présentateur l&#39;annonce avec :</p>

<blockquote>
<p>Mesdames et messieurs, un tonnerre d&#39;applaudissement pour Maurice et ses
jumelles !</p>
</blockquote>

<p>Comme quoi, il faut faire attention à tous les détails jusqu&#39;au bout.</p>

<h3>Conclusion</h3>

<p>Ce sont pour moi des conseils extrémement précieux. Certains s&#39;appliquent
particulièrement à un processus créatif, mais d&#39;autres possèdent vraiment une
portée bien plus générale.</p>

<p>J&#39;espère que vous aurez tiré quelque chose de cet article comme moi j&#39;ai tiré
quelque chose de ces conseils.</p>


    <div class="tag-list">
      
        <a href="/tags/bref">#bref</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/29/ngparis-17/">
        ngParis #17
      </a>
    </h1>

    <span class="post-date">29 Jan 2015</span>

    <p><a href="http://www.meetup.com/AngularJS-Paris/events/219615752/">Meetup angular</a>,
organisé par <a href="http://www.leboncoin.fr/">le bon coin</a>. J&#39;avais un peu arreté d&#39;aller aux
meetups angular (trop peu de contenu), mais là le programme annonçait un REX
sur comment mélanger <a href="http://facebook.github.io/react/">React</a> et <a href="https://angularjs.org/">Angular</a>, du coup, j&#39;étais
curieux.</p>

<p>Le bon coin, derrière leurs airs de sites des années 80 mis en ligne dans un
garage possède en fait de formidables bureaux en plein Paris. Le premier site
date de 2006 et est Norvégien, puis la France a été la première filiale en
2007 avant que le système ne s&#39;implante dans plus de 35 pays.</p>

<p>La technologie sous-jacente est un moteur custom codé en C nommé <a href="http://www.blocket.se/">blocket</a> et
réutilisé par toutes les filliales (qui peuvent donc faire des mises à jour de
leur moteur facilement) avec quelques petites différences culturelles pour
chaque pays.</p>

<p>D&#39;un seul dev au départ, ils sont maintenant 250 dans la boite avec un objectif
à 350 pour la fin de l&#39;année. Le bon coin, c&#39;est des chiffres de consultations
extraordinaires. 90 millions de pages vues par mois, essentiellement des
résultats de recherche, donc sans possibilité de mise en cache.</p>

<p>Ils parviennent quand même à un <code>startRender</code> moyen de 0.7s. 6e site le plus
visité de France, 700.000 nouvelles annonces chaque jour, 2 datacenters de 400
serveurs. En terme de charge, c&#39;est du très lourd, leur conso normale
correspondant aux pics de charge de ce qu&#39;on connait habituellement.</p>

<p>Au dela du cœur de l&#39;appli, il y a toutes les applications de gestion
(modération, monitoring, etc) qui sont développés dans des tas de langages
différents. Il y en a pour tous les gouts : PostgreSQL, Python, Ruby, Go,
Shell, PHP, des apps natives, du big data, de l&#39;hadoop, du capybara.</p>

<p>Ah, et la question qu&#39;on se pose tous. Non, le compte
<a href="https://twitter.com/TopBonCoin">@TopBonCoin</a> n&#39;est pas officiel, le bon coin
ne faisant actuellement aucune publicité ou community management.</p>

<p>Bon, assez parlé de l&#39;hôte, place aux talks.</p>

<h2>React et Angular</h2>

<p>Julien Bouquillon, alias <a href="https://twitter.com/revolunet">@revolunet</a> viens nous
faire un retour d&#39;expérience sur l&#39;intégration de React dans Angular. Il
a entendu beaucoup de bien de React et a voulu voir si ça se plugguait
facilement.</p>

<p>Ça fait deux ans qu&#39;il fait de l&#39;Angular, sur du mobile et sur du desktop et le
problème récurrent pour lui, ce sont les perfs. Essentiellement sur mobile
d&#39;ailleurs. Les problèmes de perf sont les mêmes sur les deux plateformes, mais
les desktop étant plus puissants, il faut vraiment de grosses apps pour
ressentir les ralentissement.</p>

<p>Vu que React mets en avant sa rapidité, il a décidé de troquer les directives
d&#39;Angular par des composants React pour voir la différence. Pour lui le reste
d&#39;Angular est très bon. On gagne en productivité et en réusabilité, le
framework fournit plein de choses de base et tout ça se teste facilement.
Globalement, super framework... sauf pour les perfs.</p>

<h3>What&#39;s wrong with Angular ?</h3>

<p>Parce que le gros problème d&#39;Angular se trouve dans le data-binding, bête et
méchant. C&#39;est le coté magique qui nous attire au début dans le framework, mais
c&#39;est aussi le goulot de performances. Quand on inclue une variable dans un
template pour qu&#39;elle soit bindée, l&#39;algo simpliste d&#39;Angular va simplement
ré-évaluer chaque variable à chaque événement de l&#39;utilisateur. C&#39;est à dire au
clic, au scroll, au touch, au keypress. Voire même sur des events qui ne
viennent pas du user, comme le retour d&#39;une requete HTTP.</p>

<p>Et ce, même si les éléments en questions sont en dehors du viewport, ou qu&#39;ils
n&#39;ont aucun rapport avec l&#39;élément actuellement modifié. Bête et méchant on
vous dit.</p>

<p>Bon, sur une appli desktop, on voit pas trop le problème, ça va super vite.
Mais sur mobile, on peut commencer à percevoir la lenteur, voir à la subir.
À chaque interaction, la totalité du DOM est réevalué, c&#39;est pas rien. C&#39;est
vraiment du <em>dirty</em> checking.</p>

<p>Si on veut fournir un expérience smooth, il nous faut viser du 60 fps, ce qui
corresponds à 16ms pour un refresh. 16ms pour un refresh de tout le DOM, c&#39;est
pas énorme.</p>

<p>Malheureusement, Angular ne nous donne pas beaucoup de points d&#39;actions pour
pouvoir influencer ou améliorer ce rendering, le processus fait plus ou moins
partie intégrante du core du méchanisme.</p>

<p>La version 1.3 a fait de grosses améliorations à ce sujet, d&#39;au moins 50% de
gain. Elle introduit aussi le principe des <code>bind-once</code>, et des filters
stateful, qui peuvent n&#39;être executés qu&#39;une seule fois pour chaque valeur
passée. On peut aussi éviter de mettre des méthodes à évaluer dans les
templates mais simplement des variables, utiliser la syntax <code>track by</code> des
<code>ng-repeat</code> et toujours essayer de mettre ses event handler sur les éléments
les plus hauts.</p>

<p>Malheureusement, il reste le cas des keypress. Si j&#39;ai un input, la totalité de
mon DOM est réévalué pour chaque touche que va taper mon utilisateur.</p>

<h3>Et React ?</h3>

<p>React de son coté fonctionne avec un système intermédiaire entre ses data et le
DOM, il y intercale un concept qui lui est propre : le virtual DOM. Les
modifications de data influent directement sur le vDOM (qui n&#39;est pas rendu
directement), et seulement le diff entre le DOM actuel et le vDOM sont reportés
dans le DOM. Ça marche très bien, et du coup seul ce qui a changé est modifié.</p>

<p>React intègre aussi par défaut un système d&#39;event delegation intelligent.
Plutôt que d&#39;ajouter des handler sur plusieurs éléments, il ajoute un handler
général sur la page et renvoie l&#39;event au bon élément cliqué. On arrete comme
ça de dupliquer les handlers.</p>

<p>Et surtout, React est explicite. Plus de magie. Chaque composant possède sa
méthode <code>render</code> qui va retourner du HTML. On peut comme ça tester unitairement
le rendu, mais surtout chaque composant est isolé et ses données ne fuitent
plus vers l&#39;extérieur. Seul le contenu du composant est modifié, sans que cela
n&#39;induise un rechargement de la totalité du DOM de la page.</p>

<p>Sans compter que React s&#39;intègre parfaitement dans l&#39;écosystem npm et
browserify.</p>

<h3>Benchmarks</h3>

<p>Il nous a fait une démo d&#39;un même composant codé une fois en Angular et une
fois en React pour voir la différence de perfs. C&#39;était un tableau de 100
éléments et de 5-6 colonnes. En cochant la première colonne de chaque
ligne, on pouvait &quot;barrer&quot; l&#39;élément.</p>

<p>En React comme en Angular, le chargement initial du composant prends environ
autant de temps. Pas de gain à attendre de ce coté là. Par contre, si on coche
une ligne du tableau Angular, les 1000 éléments sont ré-évalués alors que si on
coche celle de React, seule la ligne cliquée est modifiée.</p>

<p>Là où c&#39;est pire, c&#39;est qu&#39;en ajoutant un champ d&#39;input au dessus du tableau
Angular, chaque <code>keypress</code> ré-évaluait la totalité du tableau. Et pire que
tout, on a ajouté un bouton qui ne faisait rien (pas de <code>ng-click</code>, rien). Et
bien cliquer dessus rechargeait encore tout le DOM Angular.</p>

<p>Je crois que toute la beauté de React peut se résumer dans la phrase suivante
de Julien :</p>

<blockquote>
<p>En React, un bouton qui ne fait rien, ne fait rien.</p>
</blockquote>

<h3>Bon, et mon React il va rentrer dans mon Angular ?</h3>

<p>Oui. Il est tout à fait possible de mettre un composant React au beau milieu
d&#39;une appli Angular. Il va vivre sa vie en isolation, sans générer de reflow
Angular, et sans se modifier quand Angular se modifie.</p>

<p>Par contre si on veut l&#39;introduire dans notre cycle Angular normal, il faut le
wrapper lui-même dans une directive. Par contre, à partir du code de la
directive, on entre dans un mode <em>explicit &gt; implicit</em> où on va définir des
callbacks à notre composant qu&#39;il sera chargé d&#39;appeller quand il voudra
communiquer son état vers l&#39;extérieur, et on ajoutera aussi des méthodes au
composant pour pouvoir lui passer de nouvelles data depuis Angular.</p>

<p>C&#39;est un peu plus de plomberie, mais on est alors certain qu&#39;il ne se mettra
pas à jour sans raison, et il pourra agir en isolation complète.</p>

<p>Il existe un projet, <a href="https://github.com/davidchang/ngReact">ngReact</a> qui
défini justement ce type de directive, mais ils vont trop loin et ajoutent des
watchers automatiques pour passer les infos d&#39;Angular vers React et vice-versa,
ce qui nous fait revenir au problème de dirty checking du départ.</p>

<h3>Conclusion</h3>

<p>React peut s&#39;intégrer correctement dans Angular et vivre sa vie correctement en
profitant de manière isolée de ses avantages. La plomberie reste un peu
manuelle, mais permet une belle isolation. Néanmoins, la philosophie de l&#39;un et
de l&#39;autre étant tellement différentes, je ne suis pas sur qu&#39;on tire vraiment
le meilleur des deux mondes.</p>

<h2>KillrChat</h2>

<p><a href="https://twitter.com/doanduyhai">Duy Hai Doan</a>, tech évangéliste chez
<a href="http://www.datastax.com/">Datastax</a> nous a <a href="http://www.slideshare.net/doanduyhai/introduction-to-killrchat">parlé d&#39;un pet
project</a> de
chat à base d&#39;Angular, <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> et
<a href="http://cassandra.apache.org/">Cassandra</a>. C&#39;est cool, il est payé pour faire
des meetups et présenter Cassandra, du coup avec trois technos cools comme ça
il peut réutiliser le même talk :)</p>

<p>L&#39;idée de faire une appli de chat vient de sa frustration de faire des ateliers
pour faire découvrir Cassandra et que les élèves ne repartent qu&#39;avec un énième
&quot;Hello World&quot; qui ne sert pas à grand chose. Là, il a une vraie appli qui
touche à toutes les couches.</p>

<p>Et surtout, elle peut profiter des possibilités de scaling de Cassandra. En
gros, quand le nombre de user se mets à grossir, il suffit d&#39;augmenter le
nombre de nœuds sur lesquels les données sont stockées dans Cassandra.
Cassandra s&#39;occupe de répartir les nouvelles données uniformément sur chaque
nœud de manière à ce qu&#39;aucun ne soit particulièrement submergé. Pour plus
d&#39;infos sur le fonctionne de Cassandra, je vous invite à relire <a href="http://meetups.pixelastic.com/2014/10/15/nodejs-chapitre-2-conference-2/">mon
compte-rendu</a>
du meetup nodejs paris.</p>

<p>Le chat qu&#39;il a développé communique avec le back-end Spring Boot en websocket,
avec <a href="https://github.com/sockjs">SockJS</a>. Entre les deux, il suffit de mettre
un broker qui sait scaler (<a href="http://www.rabbitmq.com/">RabbitMQ</a>,
<a href="http://zeromq.org/">ZeroMQ</a>, <a href="http://kafka.apache.org/">Kafka</a>) qui implémente
un simple système de <a href="http://fr.wikipedia.org/wiki/PubSub">pub/sub</a> et front et
back peuvent communiquer sans soucis, même avec une forte charge.</p>

<h3>Et Angular dans tout ça ?</h3>

<p>Duy Hai vient surtout du monde Java, le front c&#39;est pas forcément son domaine.
Mais il a kiffé Angular, il s&#39;y est bien retrouvé. Il a aussi apprécié le
fait qu&#39;il y ait des outils pour <a href="http://angular-ui.github.io/bootstrap/">se plugguer facilement avec
Bootstrap</a> (car
comme il le dit lui-même, si on lui laisse le design d&#39;un site ça sera
horrible, avec bootstrap au moins c&#39;est pas trop moche).</p>

<p>Il a quand même très rapidement implémenté des tas de bonnes pratiques en
Angular (je ne sais pas si ce sont des bonnes pratiques issues de Java ou non).
Par exemple, toute sa logique est distribuéed dans des services stateless, ses
controllers se chargeant simplement d&#39;un rôle de passe-plat.</p>

<p>Par contre, comme beaucoup, il s&#39;est fait avoir par les
<a href="https://docs.angularjs.org/api/ngResource/service/$resource">$resources</a>.
Déjà, selon qu&#39;on utilise les ressources avec des méthodes d&#39;instances ou des
méthodes de classe, ce n&#39;est pas la même type d&#39;objet qui est retourné et le
chaining des promises en devient d&#39;autant plus complexe (sans parler des
promises angular qui ont leurs propres quirks).</p>

<p>Ce qu&#39;il regrette dans Angular c&#39;est qu&#39;il faille une bonne connaissance de
Javascript pour comprendre réellement ce qu&#39;il se passe sous le capot.
Heureusement pour lui, il a découvert
<a href="https://github.com/Zenika/angular-from-scratch">angular-from-scratch</a> qui se
propose de recoder les mécaniques principales d&#39;Angular depuis rien pour bien
assimiler petit à petit chacun des concepts.</p>

<p>Globalement une présentation assez chouette, un REX avec des technos sympas.</p>

<h2>Typescript</h2>

<p>Pour finir, <a href="https://twitter.com/paulsouche">Paul Souche</a>, de
<a href="http://www.sfeir.com/">Sfeir</a> nous parle de
<a href="http://www.typescriptlang.org/">Typescript</a>.</p>

<p>Bon, je vais la faire assez vite pour le coup. Typescript est une surcouche
à Javascript, un peu comme <a href="http://coffeescript.org/">Coffeescript</a>, qui
compile en Javascript. Le truc qu&#39;apporte Typescript, c&#39;est un typage fort des
variables.</p>

<p>On peut désormais définir le type de chacun de nos arguments de fonctions et
définir des interfaces de classe. Et si jamais le compilateur s&#39;aperçoit qu&#39;on
essaie de faire rentrer des ronds dans des carrés, il nous balance une
exception et il compile pas.</p>

<p>On peut aussi définir &quot;facilement&quot; des variables privées et publiques et même
génerer automatiquement des getters et des setters. Ouais, ouais, comme un vrai
javaiste.</p>

<p>Bon, à part ça y a des linters et ça génère des sourcemaps.</p>

<p>J&#39;ai vraiment beaucoup de mal à voir l&#39;intéret du truc, mais j&#39;imagine que ça
va encore plus plaire aux javaistes qui se mettent au front.</p>

<h2>Buffet</h2>

<p>Et comme souvent, le buffet qui suit les talks est toujours l&#39;occasion de
discuter et de rencontrer des gens très intéressants. Hésitez pas à venir taper
la discut&#39; si vous êtes dans un meetup la prochaine fois.</p>


    <div class="tag-list">
      
        <a href="/tags/ngparis">#ngparis</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/27/concatenatation-compression-cache/">
        Concaténation, Compression, Cache
      </a>
    </h1>

    <span class="post-date">27 Jan 2015</span>

    <p>Quand on cherche à optimiser les performances de son site web, il y a trois
éléments essentiels à faire avant toute chose. Trois méthodes très
simples à mettre en place et qui apportent un retour direct et flagrant sur la
vitesse de chargement.</p>

<p>Ces trois méthodes sont la concaténation, la compression et le cache. J&#39;ai déjà
abordé celles-ci lors d&#39;une <a href="https://www.youtube.com/watch?v=ecc1zudWmX4">présentation aux
HumanTalks</a> de Septembre 2014,
mais nous allons les détailler dans la suite de cet article.</p>

<h2>Concaténation</h2>

<p>Le principe de la concaténation est de regrouper plusieurs fichiers de même
type en un seul, afin de se retrouver avec moins de fichiers finaux
à télécharger. Les fichiers qui profitent le plus de ce système sont les
fichiers CSS et Javascript.</p>

<p>La nature même du téléchargement d&#39;assets fait que notre navigateur doit payer
certains coûts, en millisecondes, à chaque nouvel élément téléchargé. Ces coûts
sont de diverses natures:</p>

<h3>TCP Slow start</h3>

<p>TCP, le protocole de connexion qu&#39;utilise HTTP, possède un mécanisme de
slow-start qui lui permet de calculer la vitesse optimale de transmission de
l&#39;information. Pour parvenir à ce résultat, il doit effectuer plusieurs
aller-retours entre le client et le serveur, en envoyant de plus en plus en plus
de données, pour calculer la vitesse maximale possible d&#39;émission/réception. </p>

<p>Si on envoie une multitude de petits fichiers, la transmission n&#39;a jamais le
temps d&#39;atteindre sa vitesse optimale et doit recommencer ses aller-retours
pour le prochain fichier. En groupant les fichiers en un fichier de plus grande
taille, le coût de calcul n&#39;est payé qu&#39;une seule fois et le reste du fichier
peut se télécharger à la vitesse maximum.</p>

<p>À noter que maintenir les connexions à votre serveur en <code>Keep-Alive</code> permet de
réutiliser une connexion d&#39;un asset vers le suivant et donc de ne payer le coût
de calcul qu&#39;une fois. Malheureusement, activer le <code>Keep-Alive</code> sur un serveur
Apache risque aussi de limiter le nombre de connexions parallèle que votre
serveur peut maintenir.</p>

<h3>SSL</h3>

<p>De la même manière, si votre serveur utilise une connexion sécurisée, il y a un
échange de clés entre le client et le serveur qui s&#39;effectue pour vérifier que
les deux sont bien qui ils annoncent être. Ici encore, le coût de cet échange
est payé sur chaque asset téléchargé. Mettre les fichiers en commun permet donc
de ne payer le coût de cet échange qu&#39;une seule fois.</p>

<h3>Connexions parallèles</h3>

<p>Finalement, il y a une dernière limite, purement du coté du navigateur cette
fois-ci : le nombre de connexions parallèles. La norme HTTP indique qu&#39;un
navigateur devrait ouvrir un maximum de 2 connexions parallèles vers un même
serveur. Techniquement, les navigateurs récents ont augmenté cette limite à une
valeur entre 8 et 12 car 2 était beaucoup trop restrictif.</p>

<p>Cela signifie c&#39;est que si vous demandez à votre page web de télécharger
5 feuilles de style, 5 scripts et 10 images, le navigateur ne va lancer le
téléchargement que des 12 premiers éléments. Il commencera le téléchargement du
13e uniquement une fois qu&#39;un des 12 premiers sera arrivé, et ainsi de suite.
Ici encore, la concaténation vous permet de laisser plus de canaux disponibles
pour télécharger les autres assets de votre page.</p>

<p>Les fichiers CSS et Javascript se concatènent très bien. Il suffit simplement
de créer un fichier final qui contient le contenu mis bout-à-bout de tous les
fichiers initiaux. Votre processus de build devrait pouvoir s&#39;en charger sans
problème, mais un solution simple peut s&#39;écrire en quelques lignes :</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">cat ./src/*.css &gt; ./dist/styles.css
cat ./js/*.js &gt; ./dist/scripts.js
</code></pre></div>

<p>À noter que la concaténation d&#39;images (CSS Sprites) est aussi possible, mais
nous ne l&#39;aborderons pas dans cet article.</p>

<h2>Compression</h2>

<p>Maintenant que nous avons réduit le nombre de fichiers, notre deuxième tâche
va être de rendre ces fichiers plus légers, afin qu&#39;ils se téléchargent plus
rapidement.</p>

<p>Pour cela, il existe une formule magique formidable nommée Gzip qui permet de
réduire de 66% en moyenne le poids des assets textuels.</p>

<p>La bonne nouvelle c&#39;est que la majorité des assets que nous utilisons dans la
création d&#39;un site web sont du texte. Les briques principales comme le HTML, le
CSS et le Javascript bien sur, mais aussi les formats classiques de retour de
votre API : XML et JSON. Et beaucoup d&#39;autres formats qui ne sont en fait que
du XML déguisé : flux RSS, webfonts, SVG.</p>

<p>Gzip, et c&#39;est assez rare pour le souligner, est parfaitement interprété par
tous les serveurs et tous les navigateurs du marché (jusque IE5.5, c&#39;est dire).
Il n&#39;y a donc aucune raison de ne pas l&#39;utiliser.</p>

<p>Si un navigateur supporte le Gzip, il enverra un header <code>Accept-Encoding: gzip</code>
au serveur. Si le serveur décèle ce header dans la requête, il compressera le
fichier à la volée avant de le retourner au client, en y ajoutant le header
<code>Content-Encoding: gzip</code>, et le client le décompressera à la reception.</p>

<p>L&#39;avantage est donc d&#39;avoir un fichier de taille réduite qui transite sur le
réseau, avec en contrepartie le serveur et le client qui s&#39;occupent
respectivement de la compression/décompression. Sur n&#39;importe quelle machine
issue des 10 dernières années, l&#39;overhead de la compression/décompression en
gzip est absolument négligeable. Par contre, le fait d&#39;avoir un fichier bien
plus léger qui transite sur le réseau permet des gains très importants.</p>

<p>Les librairies de compression Gzip sont disponibles sur tous les serveurs du
marché, il suffit généralement simplement de les activer en leur indiquant les
types de fichiers qui doivent être compressées. Vous trouverez ci-dessous
quelques exemples sur les serveurs les plus connus :</p>

<h4>Apache</h4>

<div class="highlight"><pre><code class="language-apache" data-lang="apache"><span class="nt">&lt;IfModule</span> <span class="s">mod_deflate.c</span><span class="nt">&gt;</span>
  <span class="nt">&lt;IfModule</span> <span class="s">mod_filter.c</span><span class="nt">&gt;</span>
    <span class="nb">AddOutputFilterByType</span> DEFLATE <span class="s2">&quot;application/javascript&quot;</span> <span class="s2">&quot;application/json&quot;</span> \
    <span class="err">&quot;text/css&quot;</span> <span class="err">&quot;text/html&quot;</span> <span class="err">&quot;text/xml&quot;</span> <span class="err">[</span>...<span class="err">]</span>
  <span class="nt">&lt;/IfModule&gt;</span>
<span class="nt">&lt;/IfModule&gt;</span>
</code></pre></div>

<h4>Lighttpd</h4>

<div class="highlight"><pre><code class="language-lighttpd" data-lang="lighttpd"><span class="k">server.modules</span> <span class="o">+=</span> <span class="p">(</span> <span class="s2">&quot;mod_compress&quot;</span> <span class="p">)</span>
<span class="k">compress.filetype</span>  <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;application/javascript&quot;</span><span class="p">,</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span> <span class="err">\</span>
<span class="s2">&quot;text/css&quot;</span><span class="p">,</span> <span class="s2">&quot;text/html&quot;</span><span class="p">,</span> <span class="s2">&quot;text/xml&quot;</span><span class="p">,</span> <span class="p">[</span><span class="k">...</span><span class="p">]</span> <span class="p">)</span>
</code></pre></div>

<h4>Nginx</h4>

<div class="highlight"><pre><code class="language-nginx" data-lang="nginx"><span class="k">gzip</span> <span class="no">on</span><span class="p">;</span>
<span class="k">gzip_comp_level</span> <span class="mi">6</span><span class="p">;</span>
<span class="k">gzip_types</span> <span class="s">application/javascript</span> <span class="s">application/json</span> <span class="s">text/css</span> <span class="s">text/html</span> <span class="s">text/xml</span>
<span class="s">[...]</span><span class="p">;</span> 
</code></pre></div>

<p>S&#39;il y a bien une optimisation de performance qui nécessite peu de travail
à mettre en place et qui améliore grandement les performances de chargement,
c&#39;est bien le Gzip. Cela ne nécessite aucun changement sur les fichiers servis,
uniquement une activation de config sur le serveur.</p>

<h3>Minification</h3>

<p>Pour aller plus loin, vous pouvez aussi investir sur la minification de vos
assets. HTML, CSS et Javascript sont encore une fois les meilleurs candidats
pour la minification. </p>

<p>La minification est un procédé qui va ré-écrire le code de vos assets dans une
version qui utilise moins de caractères, et qui donc pésera moins lourd sur le
réseau. D&#39;une manière générale cela va surtout supprimer les commentaires et
les sauts de ligne, mais des minificateurs plus spécialisés pourront renommer
les variables de vos Javascript en des valeurs plus courtes, regrouper vos
sélecteurs CSS ou supprimer les attributs redondants de vos pages HTML.</p>

<p>L&#39;ajout d&#39;un processus de minification est plus complexe que l&#39;activation du
Gzip, et les gains sont aussi moins importants. C&#39;est pourquoi nous vous
conseillons de toujours commencer par la compression Gzip.</p>

<h2>Cache</h2>

<p>À présent que nous avons réussi à limiter le nombre de fichiers et à faire
baisser leur poids, la prochaine étape est de les télécharger le moins souvent
possible.</p>

<p>L&#39;idée principale ici est qu&#39;il est inutile de faire télécharger à votre
visiteur un contenu qu&#39;il a déjà téléchargé et possède donc en local sur son
poste.</p>

<p>Nous allons commencer par expliquer comment fonctionne le cache HTTP car c&#39;est
un domaine qui est généralement mal compris des développeurs. Il y a en fait
deux principes fondamentaux à comprendre dans le cache HTTP: la <em>fraicheur</em>, et
la <em>validation</em>.</p>

<h3>Fraicheur</h3>

<p>On peut voir la fraicheur d&#39;un asset comme une date limite de consommation.
Lorsque l&#39;on télécharge un élément depuis le serveur, celui-ci nous l&#39;envoie
accompagné d&#39;un header indiquant jusqu&#39;à quelle date cet élément est encore
frais.</p>

<p>Si jamais le client à besoin à nouveau du même élément, il commence par
vérifier la fraicheur de celui qu&#39;il a en cache. S&#39;il est encore frais, il ne
fait pas de requête au serveur, et utilise directement celui qu&#39;il a sur son
disque. On ne peut pas faire plus rapide, car il n&#39;y a alors absolument aucune
connexion réseau impliquée.</p>

<p>Par contre, si jamais la date de fraicheur est dépassée, alors le navigateur va
lancer une nouvelle requête au serveur pour récupérer la nouvelle version.</p>

<p>En HTTP 1.0, le serveur retourne un header <code>Expires</code> avec la date limite de
fraicheur. Par exemple: <code>Expires: Thu, 04 May 2014 20:00:00 GMT</code>. Dans cet
exemple, si jamais le navigateur demande à nouveau le même asset avant le 4 Mai
2014 à 20h, alors il le lira depuis son cache, sinon il interrogera le serveur.</p>

<p>Cette notation a un défaut majeur dans le fait que les dates sont fixées de
manière absolue. Cela signifie que le cache de tous les clients perdra sa
fraicheur en même temps. Et vous aurez donc potentiellement tous les clients
qui feront une nouvelle requête vers votre serveur en même temps pour se mettre
à jour, ce qui peut générer un très fort pic de charge à cet instant.</p>

<p>Pour limiter cela et donner plus de flexibilité dans la gestion de la
fraicheur, en HTTP 1.1, un nouveau header à été introduit : <code>Cache-Control</code>.
Celui-ci accepte plusieurs arguments qui permettent de gérer plus finement la
manière de mettre en cache, et celui qui nous intéresse ici est <code>max-age</code> qui
permet de définir une durée relative de fraicheur, en secondes.</p>

<p>Votre serveur peut donc répondre <code>Cache-Control: max-age=3600</code> pour indiquer
que l&#39;asset est encore frais pendant 1h (3600 secondes). En faisant ainsi vous
pouvez espacer les appels sur une plus longue période.</p>

<h3>Validation</h3>

<p>La deuxième composante du cache est la <em>validation</em>. Imaginons que notre asset
ai terminé sa période de fraicheur, nous allons donc récupérer une nouvelle
version de celui-ci sur le serveur. Mais il est possible que l&#39;asset n&#39;ait pas
réellement changé sur le serveur depuis la dernière fois. Il serait alors
inutile de retélécharger quelque chose que nous avons déjà dans notre cache.</p>

<p>Le principe de validation permet au serveur de gérer cela. Soit l&#39;asset du
client est identique à l&#39;asset du serveur, dans ce cas le client peut garder sa
version locale. Soit les deux sont différents et dans ce cas le client doit
mettre à jour son cache avec la version distante.</p>

<p>Lorsque le client a récupéré l&#39;asset pour la première fois, le serveur lui
a répondu avec un header <code>Last-Modified</code>, par exemple <code>Last-Modified: Mon, 04
May 2014 02:28:12 GMT</code>. La prochaine fois que le client fera une requête pour
récupérer cet asset, il renverra la date dans son header <code>If-Modified-Since</code>,
par exemple <code>If-Modified-Since: Mon, 04 May 2014 02:28:12 GMT</code>.</p>

<p>Le serveur compare alors la date envoyée et celle qu&#39;il possède de son coté.
Si les deux correspondent, alors il renverra un <code>304 Not Modified</code> pour
indiquer au client que le contenu n&#39;a pas changé. Celui-ci continuera alors
d&#39;utiliser sa version locale. Ainsi, on évite de transmettre du contenu inutile
sur le réseau.</p>

<p>Par contre si le serveur voit que le fichier qu&#39;il possède est plus récent que
la date envoyée, il répondra avec un <code>200 OK</code> et le nouveau contenu. Ainsi, le
client utilise désormais la dernière version. </p>

<p>En faisant ainsi, on évite donc de télécharger un contenu qu&#39;on possède déjà.</p>

<p>Dans les deux cas, le serveur renvoie de nouvelles informations de fraicheur.</p>

<p>Comme pour la fraicheur, il existe deux couples de headers pour communiquer des
informations de validation au serveur. En plus de <code>Last-Modified</code>
/ <code>If-Modified-Since</code> qui utilisent une date de modification, il est possible
d&#39;utiliser des ETags.</p>

<p>Un ETag est un hash qui identifie de manière unique chaque fichier. Si le
fichier change, alors son ETag change aussi. Par exemple, le serveur retourne
au client lors du premier appel un header <code>ETag: &quot;3e86-410-3596fbbc&quot;</code>, et
lorsque le client fait à nouveau appel à la même ressource, il envoie un header
<code>If-None-Match : &quot;3e86-410-3596fbbc&quot;</code>. Le serveur va comparer les deux ETags et
retourner un <code>304 Not Modified</code> s&#39;ils sont identiques ou un <code>200 OK</code> avec le
nouveau contenu s&#39;ils sont différents.</p>

<p><code>Last-Modified</code> et <code>ETag</code> possèdent des comportements très similaires, mais
nous vous conseillons d&#39;utiliser <code>Last-Modified</code> en priorité.</p>

<p>En effet, la spec HTTP indique que si un serveur retourne un <code>Last-Modified</code> et
un <code>ETag</code>, alors le navigateur doit prendre en priorité le <code>Last-Modified</code>. De
plus, la majorité des serveurs génèrent l&#39;ETag à partir de l&#39;inode du fichier,
de manière à ce que celui-ci soit modifié au moindre changement.</p>

<p>Malheureusement, ceci pose des soucis pour peu que vous ayez des serveurs
redondés derrière un load-balancer où chaque serveur possède son propre
filesystem et donc ses propres inodes. Deux fichiers identiques, sur deux
serveurs différents auront des inodes différents et par conséquent des ETag
différents.  Votre système de validation ne fonctionnera plus dès lors que
votre client sera redirigé vers un autre frontal.</p>

<p>À noter que ce problème n&#39;apparait pas sous nginx, qui ne prends pas en compte
l&#39;inode dans la génération de son ETag. Sous Apache, l&#39;option <code>FileEtag MTime
Size</code> permet de le désactiver, ainsi que <code>etag.use-inode = &quot;disable&quot;</code> sous
lighttpd.</p>

<h3>Récapitulatif</h3>

<p>À la lumière de ces explications, nous pouvons donc retracer le parcours
classique du téléchargement d&#39;un asset mis en cache.</p>

<ul>
<li>Le client effectue une première requête pour récupérer un asset. Il récupère
son <code>Cache-Control: max-age</code> pour la fraicheur et son <code>Last-Modified</code> pour la
validation.</li>
<li>S&#39;il demande à nouveau le même asset alors que celui-ci est encore frais, il
le prends directement depuis son disque local.</li>
<li>S&#39;il le demande au dela de sa date de fraicheur, il fait un appel au serveur
en envoyant son <code>If-Modified-Since</code>.</li>
<li>Si le fichier sur le serveur possède la même date de modification que celle
envoyée, il retourne un <code>304 Not Modified</code>.</li>
<li>Si le fichier sur le serveur a été modifié, il retourne un <code>200 OK</code> avec le
nouveau contenu.</li>
<li>Dans tous les cas, le serveur retourne un <code>Cache-Control</code> et un
<code>Last-Modified</code>.</li>
</ul>

<h3>Invalidation du cache</h3>

<p>Mais le cache est un animal capricieux, et nous savons tous que :</p>

<blockquote>
<p>Il y a deux choses complexes en informatique : invalider le cache et nommer
les choses.</p>
</blockquote>

<p>Et effectivement, invalider le cache de nos clients quand nous avons besoin de
faire une mise à jour est extrêmement difficile. C&#39;est en fait tellement
difficile que nous n&#39;allons pas le faire du tout.</p>

<p>Comme le navigateur mets en cache chaque URL, si nous souhaitons modifier un
contenu, il nous suffit de modifier son URL. Et les URL, c&#39;est quelque chose
que nous avons en quantité illimité. Il nous suffit de modifier le nom d&#39;un
fichier pour générer un nouvelle URL. On peut ajouter un numero de version,
un timestamp ou un hash à notre nom de fichier original pour lui générer une
nouvelle url. </p>

<p>Par exemple : <code>style-c9b5fd6520f5ab77dd823b1b2c81ff9c461b1374.css</code> au lieu de
<code>style.css</code>.</p>

<p>En mettant un cache très long sur ces assets (1 an est le maximum officiel de
la spec), c&#39;est comme si on les gardait en cache indéfiniment. Il nous suffit
juste de mettre un cache plus court sur le fichier qui les référence
(généralement le fichier HTML).</p>

<p>Ainsi, si on pousse en production une modification sur une feuille de style ou
dans un script, il nous suffit de modifier les références à ces fichiers dans
nos sources HTML pour que les clients téléchargent les nouveaux contenus. Le
cache sur les fichiers HTML est beaucoup plus court, de manière à ce que les
changements introduits par notre mise en production soient rapidement
répércutées sur nos clients.</p>

<p>Les anciens contenus seront encore en cache chez nos clients mais cela n&#39;a pas
d&#39;importance, nous ne les requêterons plus jamais et les éléments non-utilisés
du cache des clients se vident régulièrement.</p>

<p>La technique est en fait très proche des <code>Etag</code> vus précédement à la différence
qu&#39;ici nous sommes maitres de la génération du nom unique de fichier et du
moment où nous souhaitons invalider le cache de nos clients.</p>

<p>Au final, nous utilisons un mélange de ces deux techniques pour gérer un cache
optimal. </p>

<p>Les éléments dont l&#39;URL est significative, comme les pages HTML ou les
retours d&#39;une API définiront une fraicheur faible (de quelques minutes
à quelques heures, en fonction de la fréquence moyenne de mise à jour). Ceci
permet de s&#39;assurer que le client aura rapidement la nouvelle version quand
celle-ci est déployée, tout en limitant la charge sur le serveur et la quantité
d&#39;information transitant sur le réseau.</p>

<p>Pour les éléments dont l&#39;URL n&#39;est pas significative, comme les feuilles de
styles, les scripts, les polices de caractère ou les images, on utilisera une
fraicheur maximum d&#39;un an. Ceci permettra au client de garder indéfiniment la
ressource dans son cache sans avoir besoin d&#39;interroger à nouveau le serveur.
On générera par contre une URL différente en fonction d&#39;un hash du contenu
à chaque fois que le contenu vient à changer. On prendra bien garde à modifier
les références à ces fichiers dans les pages HTML.</p>

<h2>Conclusion</h2>

<p>Nous avons donc vu comment trois points très simples permettent de diminuer
grandement le nombre de total de fichiers à télécharger, les rendre plus
légers, et les télécharger moins souvent.</p>

<p>La concaténation automatique des fichiers doit être intégrée dans votre
processus de build, afin de garder un environnement de développement clair. La
compression en gzip ne nécessite que quelques modifications sur vos serveurs.
La mise en place d&#39;une stratégie de cache optimale par contre nécessite à la
fois des modifications sur le processus de build et sur la configuration des
serveurs.</p>

<p>Toutes ces modifications sont relativement peu couteuses à mettre en place et
ne dépendent aucunement ni de la technologie utilisée pour le front-end, ni de
celle utilisée pour le back-end. Elles peuvent être mise en place quelle que
soit votre stack technique. Il n&#39;y a donc plus aucune raison pour ne pas les
déployer dès aujourd&#39;hui.</p>


    <div class="tag-list">
      
        <a href="/tags/humantalks">#humantalks</a>
      
        <a href="/tags/webperf">#webperf</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/21/parisjs-42/">
        ParisJS #42
      </a>
    </h1>

    <span class="post-date">21 Jan 2015</span>

    <p>Hier soir, meetup <a href="http://parisjs.org/">parisjs</a> chez <a href="http://www.intechinfo.fr/">In&#39;Tech Info</a>, une école d&#39;informatique
du coté des Gobelins (dont les locaux semblent être un ancien parking
réaménagé).  Néanmoins, grande salle, plein de nouveaux venus, ça fait plaisir.</p>

<p>Commençons par le gros point noir du meetup. Celui-ci était censé commencer
à 19h, mais c&#39;est seulement à 19h45 que les organisateurs commencent à prendre
la parole pour annoncer le programme. Et présenter parisjs, et montrer le
nouveau site, et essayer de faire une démo d&#39;édition de markdown en live, et
faire son auto-promotion, et donner la parole à tous les sponsors pour qu&#39;ils
fasse de même, et du coup c&#39;est super long.</p>

<p>C&#39;est le même travers que le meetup <a href="http://www.meetup.com/Nodejs-Paris/">nodejs paris</a> et <a href="http://www.meetup.com/parisrb/">paris.rb</a>. Ça ne
commence jamais à l&#39;heure, et même quand ça commence, on doit encore se taper
les publicités avant le film, comme au cinéma. La prochaine fois, je viendrai
en retard.</p>

<p>Bon, fini d&#39;être aigri, il y avait une annonce intéressante quand même. NUMA
vient d&#39;ouvrir un <a href="http://cowork.numa.paris/">espace de coworking</a> de 150m², avec café à volonté,
ouvert 24h/24, à destination des développeurs, et avec un device lab.</p>

<h2>Dev Avengers</h2>

<p>Mais les talks ont ensuite relevé le niveau. <a href="https://twitter.com/porteneuve">Christophe
Porteneuve</a>, la bible vivante du Javascript, qui appelle tout les
auteurs des grands frameworks par leurs petits prénoms et qui réfléchit encore
plus vite qu&#39;il ne parle était le premier sur scène. 37 ans, toutes ses dents,
19 ans dans le web, ça envoie du lourd.</p>

<p>Il nous a présenté les <a href="http://bit.ly/devavengers">outils de travail intra-browser</a> qui permettent
d&#39;améliorer la productivité de son workflow de travail. Fini le <code>Ctrl-S</code>,
<code>Alt-tab</code>, <code>Ctrl-R</code> pour voir les modifications qu&#39;on vient de faire, on est en
2015 bourdel.</p>

<p>Petite explication de l&#39;utilité des sourcemaps, qui permettent, en ajoutant des
commentaires dans un fichier minifié de faire le mapping vers les fichiers
sources. Chrome les comprends depuis déjà 4 ans, et nous indique donc les
erreurs dans la console réellement là où elles ont lieu dans les fichiers
sources. Et encore mieux, elles peuvent faire le lien entre un fichier final et
n&#39;importe quel type de fichier source, même des preprocesseurs comme Sass, Less
ou Coffescript.</p>

<p>Tout le reste du talk donnait des exemples avec Chrome, car c&#39;est le browser
qui possède actuellement les meilleurs outils, même si Firefox et IE12 sont pas
loin derrière.</p>

<p>On sait tous qu&#39;on peut modifier le HTML et le CSS à la volée avec l&#39;inspecteur
Chrome, mais on peut aussi le faire avec du JS. Le soucis c&#39;est que nos modifs
restent en live dans la page chargée, mais que c&#39;est un peu plus compliqué pour
les récupérer dans un vrai fichier sur le disque.</p>

<p>Du coup, la solution c&#39;est les <code>workspaces</code> de Chrome. On lui définit un
dossier de notre disque dur qui contient nos sources, et une fois qu&#39;on lui
a donné l&#39;autorisation, on peut manuellement lui indiquer les mappings entre
notre filesystem et notre network. Du coup, en faisant ainsi et avec les
sourcemaps, on peut modifier directement un fichier source Sass depuis Chrome.</p>

<p>Bon, sauf que dans ce cas là, on perds la preview instantanée de nos modifs
dans le browser, parce que Chrome n&#39;a aucune idée de comment parser du Sass.
Mais c&#39;est là que notre outil de build en mode <code>watch</code> peut venir nous aider.
Grunt, Gulp et Brunch proposent tous un moyen d&#39;écouter les modifications du
filesystem pour lancer des taches en fonction des fichiers modifiés.</p>

<p>Il nous a ensuite parlé de <a href="https://github.com/facebook/fb-flo">fb-flo</a>, un outil de Facebook qui permet de lier
un fichier actuellement chargé par Chrome (CSS ou JS) à un buffer ouvert dans
son IDE, et de reporter automatiquement les modifs de l&#39;un vers l&#39;autre, sans
avoir besoin de recharger la page.</p>

<p>Dernier outil pour gagner du temps en test crossbrowser, c&#39;est <a href="http://www.browsersync.io/">BrowserSync</a>.
On ouvre autant de pages qu&#39;on le souhaite sur différents browsers, desktop et
mobile, et toute modification sur l&#39;un (scroll, typing dans un formulaire, etc)
est répercutée instantanément dans les autres. L&#39;avantage est que pour les
clics, il rejoue le même selecteur unique sur chaque device plutot que de
cliquer à des coordonnées précises.</p>

<p>Du coup, si on récapitule :</p>

<ul>
<li>Sourcemaps pour avoir la liaison entre un fichier minifié et les sources des
preprocesseurs</li>
<li>Workspaces pour faire le mapping entre un fichier du disque dur et un fichier
chargé par Chrome (marche avec les sourcemaps). <em>Je modifie dans Chrome, ça
change sur mon disque</em>.</li>
<li>fb-flo pour faire du livereload du browser dès qu&#39;un fichier du disque
change. <em>Je modifie sur mon disque, ça recharge dans Chrome</em>.</li>
<li>BrowserSync pour tester sur plusieurs devices/browsers en parallèle.</li>
</ul>

<p>On a discuté ensuite autour d&#39;une bière et d&#39;une pizza où il m&#39;a convaincu
d&#39;essayer <code>Stylus</code>. Syntaxe &quot;clean&quot;, à la <code>ruby</code>, <code>jade</code> ou <code>coffeescript</code>. Je
ne suis pas fan de cette épuration habituellement, mais j&#39;avoue n&#39;avoir jamais
réellement essayé. Par contre le fait de pouvoir redéfinir les propriétés de
base CSS (du genre, dès que je mets telle propriété avec telle valeur, alors ça
mets automatiquement telle autre). Et aussi, les variables des <code>mixins</code> sont
scopées, ce qui est le truc qui m&#39;ennuie le plus avec Sass.</p>

<p>Dans le même genre, il m&#39;a vendu <code>brunch</code> comme étant un grunt-like à base de
<em>convention over configuration</em> (ce qui est tout le contraire de Grunt et de
son <em>configuration over configuration over configuration</em>...). Du coup, faut
vraiment que je teste.</p>

<p>Et il a même dit du bien de <code>famous</code> (un peu moins d&#39;<code>angular</code>, forcément).</p>

<h2>IONIC</h2>

<p><a href="https://twitter.com/cedriclombardot">Cédric Lombardot</a> nous parle de Ionic
Framework.</p>

<p>Alors, <a href="http://ionicframework.com/">Ionic</a> c&#39;est un framework qui combine
<a href="https://angularjs.org/">Angular</a> et <a href="http://cordova.apache.org/">Cordova</a> pour
développer des applications hybrides. </p>

<p>Cédric commence par nous expliquer les avantages et inconvénients de faire de
l&#39;hybride. Le gros avantage de l&#39;hybride c&#39;est que c&#39;est le même code pour
toutes les plateformes, ce qui évite de devoir faire deux applications, pour
Android et iPhone, qui coutent deux fois plus cher.</p>

<p>Par contre, mieux vaut éviter l&#39;hybride si on a besoin de perfs au top, parce
qu&#39;une surcouche sera toujours plus lente que du natif. Ce qui inclue tous les
super effets d&#39;animation mouf-mouf. Si on a besoin de certaines API très liées
au device, Cordova ne nous y donnera pas forcément accès. Et finalement, si on
n&#39;a besoin de développer que pour une unique plateforme, autant partir sur du
natif.</p>

<p>Dans les deux cas, pour pouvoir passer son app sur iPhone, il faudra passer par
les 15 jours de validation Apple. Il n&#39;y a rien dans les CGU d&#39;Apple qui bloque
l&#39;hybride plus que le natif.</p>

<p>Maintenant, parlons de ce qu&#39;apporte Ionic. Déjà, il utilise Cordova, qui est
le moteur open-source utilisé par Phonegap. Il gère aussi parfaitement les
affichages d&#39;élements dans une page, même quand on fait apparaitre/disparaitre
le clavier (source de bugs divers).</p>

<p>Avec Ionic, on fait une application, pas un site web. On passe sur un paradigme
où on réfléchit en terme de &quot;vues&quot; (écrans), et on doit alors penser à comment
ceux-ci s&#39;emboitent, quel est le comportement du bouton back, etc.</p>

<p>Ionic est fourni avec des directives (Angular oblige) pour la majorité des
éléments de UI classiques d&#39;une app : header, footer, listes avec
pull-to-refresh, swipe sur item pour avoir un menu, drag&#39;n&#39;drop, popup de choix
d&#39;action, slideshow, etc</p>

<p>Ça s&#39;installe classiquement à base de <code>npm</code> et génère un code boilerplate avec
une petite appli pour comprendre comment les différents éléments interagissent.
Si vous voulez vraiment aller vite, il existe même le <a href="http://ionicframework.com/creator/">Ionic
Creator</a> pour générer sa UI à base de
drag&#39;n&#39;drop.</p>

<p>Ça pêche encore du coté Android quand le browser par défaut est le stockbrowser,
qui a des perfs bien moins bonne que Chrome. Il y a des solutions en cours de
développement pour contrer ça. Il n&#39;est pas non plus compatible sous Windows
Phone pour le moment.</p>

<p>Coté UI, Ionic vient avec son propre style. Il y a des essais pour reproduire
un style natif Android ou iPhone, mais c&#39;est pas encore au point et jQuery
mobile est plus avancé de ce coté là apparemment. Par contre, on a quand même
le droit à une classe CSS sur le root indiquant si on est sous Android ou sous
IOS pour tweaker notre app en fonction.</p>

<h2>VIRTJS</h2>

<p><a href="https://github.com/arcanis">Maël Nison</a> est venu nous parler un peu plus de
Ionic, qu&#39;il a utilisé sur un projet perso nommé <a href="http://m.start9.io/">Start9</a>.</p>

<p>Maël avait <a href="http://arcanis.github.io/presentation.parisjs-20140625/#/step-1">déjà
présenté</a> un
émulateur gameboy qu&#39;il avait développé en javascript. Il a cette fois-ci
poussé le concept un peu plus loin en proposant un site web en Ionic,
accessible donc depuis n&#39;importe quel browser, sur lequel on puisse uploader
ses roms Gameboy et y jouer directement dans le navigateur.  L&#39;avantage est
d&#39;avoir un système crossplatform, on peut commencer sa partie sur son téléphone
dans le métro et la continuer au même endroit sur son desktop plus tard.</p>

<p>Le gros avantage est que c&#39;est un simple site web. Pas besoin d&#39;installer
quoique ce soit pour l&#39;utilisateur, et pas besoin de passer par la validation
appStore pour le créateur.</p>

<p>Coté techno, c&#39;est du node en backend, avec du
<a href="http://sequelizejs.com/">sequelize</a> (ORM pour taper sur PostgreSQL et SQLite).
<a href="https://github.com/systemjs/systemjs">Systemjs</a> et
<a href="https://github.com/google/traceur-compiler">Traceur</a> pour ses modules ES6
transformés en ES5. Comme ça, le jour où ES6 est partout, on peut enlever la
transformation. Et sinon, du Ionic pour le front.</p>

<p>Pour la suite ils envisagent de supporter de plus en plus de jeux, et de plus
en plus de consoles. Ils passeront aussi à Angular 2 quand il sortira (pour
rester sur une stack ES6). Leur retour sur Ionic c&#39;est que c&#39;est cool mais
encore jeune, les issues sont fixées rapidement (si les mainteners sont pas en
vacances...).</p>

<h2>Conclusion</h2>

<p>Une bonne soirée ParisJS, avec 3 talks très intéressant, une grande salle, de
la pizza pour tout le monde et des discussions intéressantes autour d&#39;une
bière.</p>


    <div class="tag-list">
      
        <a href="/tags/parisjs">#parisjs</a>
      
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/01/07/2015-01-07-skethfab-&-3dhubs/">
        Skethfab &amp; 3DHubs
      </a>
    </h1>

    <span class="post-date">07 Jan 2015</span>

    <p>Sketchfab organisait à Numa un meetup, en partenariat avec 3DHubs. Je suis
arrivé en retard (19h pour début à 18h), et du coup j&#39;étais très mal placé (sur
un fauteuil dos à la scène, derrière un pilier, au fond). Vu qu&#39;il n&#39;y avait
pas de micro pour les questions de l&#39;audience, je n&#39;ai pu qu&#39;entendre les
réponses.</p>

<p>Ce que j&#39;ai pu en retirer, une machine &quot;perso&quot; coute dans les 3000€ et la
majorité des gens sur 3DHubs ne le font pas pour gagner de l&#39;argent (s&#39;ils
peuvent se rembourser la machine c&#39;est déjà bien), mais pour rencontrer
d&#39;autres makers.</p>

<p>Et... c&#39;était fini !</p>

<p>camera à 300€ sur un ipad + appli pour faire des scans 3D.
musées de Londres ont scanné et ouvert au public Ramses 2. Pas trop d&#39;interet
en France, semble plus rpotégé. Artistes font des copies &quot;pirates&quot; dans les
musées, dans les parcs (environ 5 minutes).</p>


    <div class="tag-list">
      
    </div>
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>

        </div>
      </div>
    </div>

    <!-- fileblock:js js -->
    <script src="/js/zepto.min.js"></script>
    <script src="/js/moment.js"></script>
    <script src="/js/lodash.min.js"></script>
    <script src="/js/algoliasearch.min.js"></script>
    <script src="/js/steppe.js"></script>
    <script src="/js/search.js"></script>
    <!-- endfileblock -->
  </body>

</html>
